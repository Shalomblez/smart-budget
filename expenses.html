<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Budget - Expenses</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>
<style>
body { font-family: Arial; margin:20px; background:#f4f6f9;}
h1{color:#2c3e50;}
label, input, select, button{display:block; margin:5px 0; padding:8px;}
button{background:#27ae60; color:white; border:none; cursor:pointer; border-radius:4px;}
button:hover{background:#1e8449;}
section{background:white; padding:15px; margin:15px 0; border-radius:8px;}
table{width:100%; border-collapse:collapse; margin-top:10px;}
th,td{border:1px solid #ddd; padding:8px; text-align:left;}
th{background:#2980b9; color:white;}
</style>
</head>
<body>
<h1>Add Expense</h1>

<section>
  <label>Category:</label>
  <select id="category">
    <option value="Food">Food</option>
    <option value="Travel">Travel</option>
    <option value="Shopping">Shopping</option>
    <option value="Bills">Bills</option>
    <option value="Others">Others</option>
  </select>

  <label>Amount (₹):</label>
  <input type="number" id="amount">

  <label>Description:</label>
  <input type="text" id="desc">

  <label>Date:</label>
  <input type="date" id="date" value="">
  
  <button onclick="addExpense()">Add Expense</button>
</section>

<section>
  <h2>Expenses List</h2>
  <table>
    <thead>
      <tr><th>Date</th><th>Category</th><th>Description</th><th>Amount (₹)</th></tr>
    </thead>
    <tbody id="expenseTable"></tbody>
  </table>
</section>

<script src="script.js"></script>
<script>
function addExpense(){
  const category = document.getElementById("category").value;
  const amount = document.getElementById("amount").value;
  const desc = document.getElementById("desc").value;
  const date = document.getElementById("date").value || new Date().toISOString().split("T")[0];

  SmartBudget.saveExpense(category, amount, desc, date);
  loadExpenses();
}

async function loadExpenses(){
  const month = new Date().getMonth()+1;
  const year = new Date().getFullYear();
  const key = `${year}-${month}`;

  const db = firebase.database();
  const snapshot = await db.ref("expenses/" + key).get();

  let tbody = document.getElementById("expenseTable");
  tbody.innerHTML = "";
  if(snapshot.exists()){
    Object.values(snapshot.val()).forEach(exp=>{
      tbody.innerHTML += `<tr>
        <td>${exp.date}</td>
        <td>${exp.category}</td>
        <td>${exp.desc}</td>
        <td>₹${exp.amount}</td>
      </tr>`;
    });
  }
}
loadExpenses();
</script>
</body>
</html>
